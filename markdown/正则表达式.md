# 正则表达式

[TOC]

## 概述

> 正则：也叫规则，让计算机能够读懂人类的规则
> 正则都是操作字符串
> array、object、regexp对比：
> 四个方法：检查、搜索、匹配、替换

```
var arr = [];
var arr = new Array;

var obj = {};
var obj = new Object();

var re = /8/;
var re = new RegExp();
简写方式要比对象方式性能要好，但是个别情况只能用对象方法实现
```

## test()方法

> 正则去匹配字符串，如果匹配成功就返回真，如果匹配失败就返回假

**写法：**

```
正则.test(字符串)
```

**例子：**

```
var str = 'abcdef';
var re = /b/;
console.log(re.test(str));//true
```

**判断字符串中是否全是数字**

```
var str = '123191!@#&*$32819';
var re = /[^\d]/;
if(!re.test(str)){
    console.log('全是数字!');
}else{
    console.log('含有非数字!');
}
```

> \s空格
> \S非空格
> \d数字
> \D非数字
> \w字符(字母、数字、下划线_)
> \W非字符

## search()方法

> 正则去匹配字符串，如果匹配成功，就返回匹配成功的位置，匹配失败就返回-1

**写法：**

```
字符串.search(正则)
```

**例子**

```
var str = 'abcoffeedef';
var re = /coffee/;
console.log(str.search(re));//2
```

> 正则默认是区分大小写
> 如果不区分大小写，在正则最后加标识`i`

```
var str = 'abcoffeedef';
var re = /COFFEE/i;
var re2 = new RegExp('coffee','i');
console.log(str.search(re));
console.log(str.search(re2));
```

## match()方法

> 正则去匹配字符串，如果匹配成功，就返回匹配成功的数组，不成功，就返回null

```
var str = 'sakdf123kjfasfk456klasf789faskjf0';
var re = /\d/g;
console.log(str.match(re));// ["1", "2", "3", "4", "5", "6", "7", "8", "9", "0"]
```

**写法：**

```
字符串.match(正则)
```

> 正则默认，匹配成功就会结束，不会继续匹配
> 如果要全局匹配，在正则最后加标识`g`

**量词**

> 匹配不确定的位置
> +：至少出现一次

```
var str = 'sakdf123kjfasfk456klasf789faskjf0';
var re = /\d+/g;
console.log(str.match(re));// ["123", "456", "789", "0"]
```

## replace()方法

> 正则去匹配字符串，匹配成功的字符去替换成新的字符

**写法：**

```
字符串.replace(正则, 新的字符串)
```

**例子**

```
var str = 'sakdf123kjfasfk456klasf789faskjf0';
var re = /\d+/g;
console.log(str.replace(re,'非非'));// sakdf非非kjfasfk非非klasf非非faskjf非非
```

**敏感词过滤**

```
var str = '垃圾费刷卡你妹是老师看色情打开屁看到狗屎';
var re = /['垃圾','你妹','色情','狗屎']/g;
console.log(str.replace(re,'*'));// **费刷卡**是老师看**打开屁看到**
```

### replace第二个参数，可以是字符串，也可以是函数

> 两种思路，第二种思路，直接`replace`，无论多少个字符，都只替换成一个`*`
> 所以需要使用回调函数

```
var str = '垃圾费刷卡你妹是老师看色情打开屁看到狗屎阿发你去死分';
var re = /['垃圾','你妹','色情','狗屎','你去死']/g;
console.log(str.replace(re,'*'));// **费刷卡**是老师看**打开屁看到**阿发***分
console.log(str.replace(re,function(){
    return '*';
}));// **费刷卡**是老师看**打开屁看到**阿发***分
```

```
var str = '垃圾费刷卡你妹是老师看色情打开屁看到狗屎阿发你去死分';
var re = /垃圾|你妹|色情|狗屎|你去死/g;
console.log(str.replace(re,'*'));// *费刷卡*是老师看*打开屁看到*阿发*分
console.log(str.replace(re,function(str){
var rtn = '';
for(var i=0;i<str.length;i++){
    rtn+='*';
}
return rtn;
}));// **费刷卡**是老师看**打开屁看到**阿发***分
```

## 小括号

> 匹配子项
> 把正则的整体叫做（母亲）
> 然后把左边第一个小括号里面的正则，叫做这个第一个子项（母亲的第一个孩子）

```
str.replace(re,function($0,$1,$2){
	// 第一个参数：$0-母亲
	// 第二个参数：$1-第一个孩子
	// 第三个参数：$2-第二个孩子
})
```

```
var str = 'abc123efk456laskf789aslf0';
var re = /(123)|(456)|(789)|(0)/g;
str.replace(re,function($0,$1,$2,$3){
    console.log($0,$1,$2,$3);
    return '*';
});
// 123 123 undefined undefined
// index.html:5 456 undefined 456 undefined
// index.html:5 789 undefined undefined 789
// index.html:5 0 undefined undefined undefined
```

**match**

> 当match不加g的时候才可以获取到子项的集合

```
var str = 'abc';
var re = /(a)(b)(c)/;
console.log(str.match(re));//["abc", "a", "b", "c", index: 0, input: "abc"]
var re = /(a)(b)(c)/g;
console.log(str.match(re));//["abc"]
```

## 字符类

> [bde]代表一个整体

```
var str = 'abc';
re = /a[bde]c/;
console.log(re.test(str));//true
```

**排除**

> ^如果^写在[]里面的时候，就代表排除的意思

```
var str = 'awc';
re = /a[^bde]c/;
console.log(re.test(str));
```


## 修饰符

修饰符 | 描述
--- | ---
i | 执行对大小写不敏感的匹配。
g | 执行全局匹配（查找所有匹配而非在找到第一个匹配后停止）。
m | 执行多行匹配。

## 量词

量词 | 描述
--- | ---
n+ | 匹配任何包含至少一个 n 的字符串。
n* | 匹配任何包含零个或多个 n 的字符串。
n? | 匹配任何包含零个或一个 n 的字符串。
n{X} | 匹配包含 X 个 n 的序列的字符串。
n{X,Y} | 匹配包含 X 至 Y 个 n 的序列的字符串。
n{X,} | 匹配包含至少 X 个 n 的序列的字符串。
n$ | 匹配任何结尾为 n 的字符串。
^n | 匹配任何开头为 n 的字符串。
?=n | 匹配任何其后紧接指定字符串 n 的字符串。
?!n | 匹配任何其后没有紧接指定字符串 n 的字符串。

## 方括号

> 方括号用于查找某个范围内的字符

表达式 | 描述
--- | ---
[abc] | 查找方括号之间的任何字符。
[^abc] | 查找任何不在方括号之间的字符。
[0-9] | 查找任何从 0 至 9 的数字。
[a-z] | 查找任何从小写 a 到小写 z 的字符。
[A-Z] | 查找任何从大写 A 到大写 Z 的字符。
[A-z] | 查找任何从大写 A 到小写 z 的字符。
[adgk] | 查找给定集合内的任何字符。
[^adgk] | 查找给定集合外的任何字符。
(red|blue|green) | 查找任何指定的选项。

## 元字符

> 元字符（Metacharacter）是拥有特殊含义的字符

元字符 | 描述
--- | ---
. | 查找单个字符，除了换行和行结束符。
\w | 查找单词字符。
\W | 查找非单词字符。
\d | 查找数字。
\D | 查找非数字字符。
\s | 查找空白字符。
\S | 查找非空白字符。
\b | 匹配单词边界。
\B | 匹配非单词边界。
\0 | 查找 NUL 字符。
\n | 查找换行符。
\f | 查找换页符。
\r | 查找回车符。
\t | 查找制表符。
\v | 查找垂直制表符。
\xxx | 查找以八进制数 xxx 规定的字符。
\xdd | 查找以十六进制数 dd 规定的字符。
\uxxxx | 查找以十六进制数 xxxx 规定的 Unicode 字符。


